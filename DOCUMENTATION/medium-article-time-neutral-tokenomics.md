# Time-Neutral Tokenomics: How We Made DeFi Rewards Provably Fair

Everyone in DeFi worries about fairness. Early LPs get outsized rewards. Latecomers subsidize incumbents. Yield farming devolves into a race where timing matters more than contribution. We decided to fix this mathematically — not with governance theater, but with game theory proofs that execute on-chain.

This is the story of how we built provably fair reward distribution into VibeSwap using Shapley values, pairwise proportionality verification, and an immutable first-to-publish priority registry.

---

## The Problem: Time Bias in Token Distribution

Most DeFi protocols reward early participants disproportionately. Liquidity mining programs front-load emissions. Yield curves decay. The message is clear: *be early or be punished*.

This creates a perverse incentive structure. People rush in not because they believe in the protocol, but because the math rewards speed over substance. The person who provides $10M of liquidity in Year 3 — when the protocol actually needs deep markets — earns a fraction of what someone who parked $100K in Week 1 collected.

Bitcoin has this problem too, but Bitcoin is transparent about it. Block rewards halve every 210,000 blocks. Everyone knows the schedule. Transaction fees, however, are always 100% — miners in 2040 earn the same fee percentage as miners in 2009.

We wanted that same principle for DeFi rewards.

---

## The Solution: Five Shapley Axioms

The Shapley value is a concept from cooperative game theory that answers a simple question: *given a group of people who created value together, how should that value be fairly divided?*

Lloyd Shapley proved in 1953 that there is exactly one allocation method satisfying four axioms: Efficiency, Symmetry, Null Player, and Additivity. We added a fifth — **Time Neutrality** — and replaced Additivity with **Pairwise Proportionality** for on-chain verifiability.

### The Five Axioms

**1. Efficiency** — All value is distributed. No value leaks, no treasury rake on fee distribution.

```
Σφᵢ = V (sum of all allocations equals total value)
```

**2. Symmetry** — Equal contributors receive equal rewards. If Alice and Bob provide identical liquidity for identical durations, they earn identically.

**3. Null Player** — Zero contribution means zero reward. No free riders.

**4. Pairwise Proportionality** — For any two participants, the ratio of their rewards equals the ratio of their weighted contributions.

```
φᵢ/φⱼ = wᵢ/wⱼ
```

This is verified on-chain via cross-multiplication to avoid division:

```
|φᵢ × wⱼ - φⱼ × wᵢ| ≤ ε
```

**5. Time Neutrality** — Identical contributions in different epochs yield identical rewards (for fee distribution games).

This is the new axiom. It means: if you provide 10 ETH of liquidity for 30 days with identical market conditions in Year 1 and Year 5, your fee share is exactly the same. Your work didn't change. Your reward shouldn't either.

---

## Two-Track Distribution

Here's where it gets interesting. We don't apply Time Neutrality universally — we apply it where it matters.

### Track 1: Fee Distribution (Time-Neutral)

Trading fees generated by the protocol are distributed via pure proportional Shapley. No halving. No decay. Same work, same reward, forever.

This is the "transaction fees" analog from Bitcoin. Miners always earn 100% of transaction fees regardless of which halving era they're in.

### Track 2: Token Emissions (Scheduled)

If the protocol ever issues governance tokens, those follow a Bitcoin-style halving schedule. Era 0 gets full emissions, Era 1 gets 50%, Era 2 gets 25%, and so on.

This is intentionally *not* time-neutral. It's a bootstrapping incentive — like Bitcoin block rewards. Everyone knows the schedule in advance. It's transparent, predictable, and opt-in.

The key insight: **fees and emissions are economically distinct**. Conflating them — as most DeFi protocols do — is what creates unfair time bias.

---

## The Cave Theorem

> *"Tony Stark was able to build this in a cave! With a box of scraps!"*

There's a natural objection: "If early contributors don't get time-based advantages, why would anyone build the hard stuff early?"

The answer is that Shapley values *already* reward foundational work — not because of when it was done, but because of its marginal contribution.

Consider a protocol with three contributors:
- **Founder**: Built the core protocol (100 ETH equivalent contribution, 365 days, high scarcity and stability scores)
- **Contributor 1**: Added a feature (10 ETH, 30 days)
- **Contributor 2**: Minor improvement (5 ETH, 15 days)

The Shapley value for the Founder dominates because removing them collapses the entire value of the coalition. Their *marginal contribution* — what the protocol loses without them — is enormous.

**Corollary 4.1:** A foundational contributor with the highest marginal contribution earns the most — not because of timing, but because of impact.

**Corollary 4.2:** If someone builds something equally foundational in a later era, they earn equally. Difficulty is captured by impact, not time.

We proved both on-chain. The tests pass. The math is the proof.

---

## First-to-Publish Priority

Time neutrality for rewards doesn't mean we ignore chronological priority. Being the first to *innovate* — to create a new market, to bootstrap liquidity for an untested pair, to build infrastructure nobody else would build — deserves recognition.

We built a **PriorityRegistry**: an immutable on-chain record of who published what first.

### How It Works

The registry tracks four categories of foundational acts:

| Category | Weight | Description |
|----------|--------|-------------|
| POOL_CREATION | 10000 | First to create a trading pair |
| LIQUIDITY_BOOTSTRAP | 7500 | First to provide significant liquidity |
| STRATEGY_AUTHOR | 5000 | First to publish a verified strategy |
| INFRASTRUCTURE | 5000 | First to deploy supporting infrastructure |

When a pioneer creates a pool, the PriorityRegistry records their address, timestamp, and block number. This record is immutable — once published, it cannot be overwritten. Only deactivatable by governance for proven fraud.

### Pioneer Bonus

The pioneer score feeds into the Shapley computation as a **weight multiplier**:

```
pioneerMultiplier = 1.0 + pioneerScore / 20000
```

A pool creator (score 10000) gets a 1.5x multiplier on their weighted contribution. Someone who both created the pool AND bootstrapped its liquidity (score 17500) gets 1.875x.

Critically, this bonus is:
- **Not time-biased**: A pioneer who creates a new pool in Year 5 gets the same bonus as one who created a pool in Year 1
- **Proportional**: Higher innovation scores yield proportionally higher bonuses
- **Verifiable**: Anyone can call `getPioneerScore()` on-chain to audit
- **Opt-in**: Only applies when both the registry and game scope are configured

### Why This Is Different

Most "first mover advantages" in DeFi are implicit — they emerge from emission curves and lockup mechanics. Ours is explicit, transparent, and mathematically bounded. You know exactly what bonus a pioneer gets, why they get it, and you can verify it yourself.

---

## On-Chain Verification

Every fairness claim is verifiable on-chain. We built a `PairwiseFairness` library with five verification functions:

1. **`verifyPairwiseProportionality()`** — Cross-multiplication check that reward ratios match contribution ratios
2. **`verifyTimeNeutrality()`** — Confirms identical contributions yield identical rewards across games
3. **`verifyEfficiency()`** — Sum of allocations equals total value
4. **`verifyNullPlayer()`** — Zero contribution means zero reward
5. **`verifyAllPairs()`** — O(n²) full game verification for dispute resolution

These aren't just theoretical. We wrote 11 proof-by-execution tests including fuzz tests that verify the axioms hold for random inputs:

```
[PASS] test_axiom1_efficiency
[PASS] test_axiom2_symmetry
[PASS] test_axiom3_nullPlayer
[PASS] test_axiom4_pairwiseProportionality
[PASS] test_axiom4_pairwiseAllPairs
[PASS] test_axiom5_timeNeutrality_feeDistribution
[PASS] test_twoTrack_emissionsHalved_feesNot
[PASS] testFuzz_pairwiseProportionality (256 runs)
[PASS] testFuzz_timeNeutrality (256 runs)
[PASS] test_caveTheorem_marginalContributionDominates
[PASS] test_caveTheorem_equalFoundationalWorkEqualReward
```

Plus 16 PriorityRegistry tests and 7 pioneer integration tests. 447 total tests, all passing.

---

## Credible Neutrality

The governance roadmap for these contracts follows a credible neutrality progression:

1. **Owner-controlled** (development phase) — necessary while building
2. **DAO Governance** — transfer ownership to community-controlled treasury with time-locked execution
3. **Renounce entirely** — parameters become immutable, protocol runs autonomously

Once ownership is renounced, the rules are the rules. No admin keys. No multisig overrides. The math executes itself.

This is what "trustless" actually means — not "trust us, we're decentralized," but "here are the proofs, verify them yourself, and nobody can change them."

---

## Summary

| Property | How It's Achieved | Verification |
|----------|-------------------|--------------|
| Same work = same reward | Time-neutral fee distribution (no halving) | `verifyTimeNeutrality()` |
| Reward ratio = contribution ratio | Proportional Shapley allocation | `verifyPairwiseProportionality()` |
| All value distributed | Remainder-to-last-participant pattern | `verifyEfficiency()` |
| No free riders | Zero weight → zero reward | `verifyNullPlayer()` |
| Innovation recognized | PriorityRegistry first-to-publish | `getPioneerScore()` |
| Foundational work rewarded | Marginal contribution dominance | Cave Theorem (Corollary 4.1) |
| Transparent emissions | Bitcoin-style halving (opt-in track) | `getHalvingInfo()` |

The code is the proof. The proofs are the code. And when we renounce ownership, they become immutable law.

---

*Built in a cave. With a box of scraps. For everyone who comes after.*
